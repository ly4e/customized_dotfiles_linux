echo 'Hello from .zshrc'

# ### items needing to be installed and various pre-req commands ###
#   install exa, batcat, fd-find
# ------------
## sim link creations (so i don't have to remember) ##
##  ln -s <abs/relative path to real/src file/> <absolute or relative path to the fake, false, target item/> 
#   ln -s ~/.dotfiles/zshrc ~/.zshrc
# ------------

# # set variables #
#export MANPAGER="sh -c 'col -bx | bat -l man -p'" ### for osX or systems that use the bat program name
#export MANPAGER="sh -c 'col -bx | batcat -l man -p'" ### most debian or ubuntu systems will use batcat
## man 2 select ### an example line


# ## changing some of ZSH options ##
# Configureation of the shell's history
HISTSIZE=10000
SAVEHIST=150000
HISTFILE=~/.zsh_history

# ## customize prompt(s) ##
# ### User Configurations ###
autoload -U colors && colors
setopt PROMPT_SUBST

# ## Creating a fish like collapsed directory listing ##
_fishy_collapsed_wd() {
    local i pwd
        pwd=("${(s:/:)PWD/#$HOME/~}")
    if (($#pwd > 1 )); then
        for i in {1..$(($#pwd-1))}; do
            if [[ "$pwd[$i]" = .* ]]; then
                pwd[$i]="${${pwd[$i]}[1,2]}"
            else
                pwd[$i]="${${pwd[$i]}[1]}"
            fi
        done
    fi
    echo "${(j:/:)pwd}"
}

# %L shows the $SHLVL (shell level) to help know how deep within shells one might be
# %n == username
# %m == machine name
# %# == changes prompt if the shell is running with privs
# can reference the following for additional options and details ### http://zsh.sourceforge.net/Doc/Release/Prompt-Expansion.html
PROMPT='
%L ðŸ™ŠðŸ™ˆðŸ™‰ %{$fg_bold[cyan]%}$(_fishy_collapsed_wd)%{$reset_color%} %#>> '

#RPROMPT='%*'


# ## Use ZSH Plugins ##





# ## ... and other surprises ##





# ## Add locations to $PATH Variables ##

# something for my MacOS for later
# Adding VSCode (code)
# export PATH="$PATH:/Applications/Virtual Studio Code.app/Contents/Reseources/app/bin"


#Command-line tools - Fail-safe command aliases
# $AGENT[x] environment variable for use with other commands:
export AGENT1="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36"
export AGENT2="Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)"
export AGENT="$AGENT1"
alias curl="curl -A '$AGENT'"
alias wget="wget -U '$AGENT'"
alias nmap="nmap --script-args=\"http.useragent='$AGENT'\""
##additionl example for wpscan
##wpscan --ua "$AGENT" --url 127.0.0.1

# setting environment variables to hold source and destination IPs for use in various efforts
export sIP=127.27.27.27
export tIP=127.111.111.111


# ## Handy Functions ##
function mkcd() {
    mkdir -p "$@" && cd "$_";
}

function dockershellhere() {
	    dirname=${PWD##*/}
	        docker run --rm -it --entrypoint=/bin/bash -v `pwd`:/${dirname} -w /${dirname} "$@"
	}
function dockershellshhere() {
	    dirname=${PWD##*/}
	        docker run --rm -it --entrypoint=/bin/sh -v `pwd`:/${dirname} -w /${dirname} "$@"
	}
function smbservehere() {
	    local sharename
	        [[ -z $1 ]] && sharename="SHARE" || sharename=$1
		    docker run --rm -it -p 445:445 -v "${PWD}:/tmp/serve" rflathers/impacket smbserver.py -smb2support $sharename /tmp/serve
	}






# ## Additional  Aliases ##
 # to use original command if alias overwrites the name use `command <ls>` to invoke the original ls
#alias ls='exa -halF --group-directories-first --sort extension'
alias ls='exa -hlF --group-directories-first --sort extension'
alias rsrc="source ~/.zshrc"
alias esrc="vim ~/.zshrc"

#Adding a temp command for screenkey version 1.4 where repo only provides v1.2. \
#Version 1.4 allows for quick disabling of showing keys to allow for password typing when needed
alias screenkey="~/Downloads/screenkey-1.4/screenkey"

alias man="batman"
alias grep="batgrep"
alias ":q"="exit"

alias lulz="lolcat"
alias lll="exa -halF | lolcat"

# alias'ing tldr to a docker container verses installing it locally on the system
# will want to make a similar non-priv container
alias tldr='docker run --rm -it -v ~/.tldr/:/root/.tldr/ nutellinoit/tldr'


##############
# recreating a fish abbreviation expansion functionality
##############
# Adding the code required to add fish like abbreviation expansion declare a list of expandable aliases to fill up later
# https://dev.to/frost/fish-style-abbreviations-in-zsh-40aa
typeset -a ealiases
ealiases=()

# write a function for adding an alias to the list mentioned above
function abbrev-alias() {
	alias $1
	ealiases+=(${1%%\=*})
	}
# expand any aliases in the current line buffer
function expand-ealias() {
	if [[ $LBUFFER =~ "\<(${(j:|:)ealiases})\$" ]]; then
		zle _expand_alias
		zle expand-word
	fi
	zle magic-space
}
zle -N expand-ealias

# Bind the space key to the expand-alias function above, so that space will expand any expandable aliases
bindkey ' '        expand-ealias
bindkey '^ '       magic-space     # control-space to bypass completion
bindkey -M isearch " "      magic-space     # normal space during searches

# A function for expanding any aliases before accepting the line as is and executing the entered command
expand-alias-and-accept-line() {
	expand-ealias
	zle .backward-delete-char
	zle .accept-line
}
zle -N accept-line expand-alias-and-accept-line

###############
# Fish-style abbreviations
###############

#Generic system abbreviations
#abbrev-alias ll="ls -hAlp"
#abbrev-alias ld="ls -Ag |grep ' \.'"
abbrev-alias myips="ip -c -brief -4 a"
##abbrev-alias resrc="source ~/.zshrc"
# for the gits :)
abbrev-alias g="git"
abbrev-alias gst="git status"
abbrev-alias gcb="git checkout --branch"
abbrev-alias gc="git clone" 
abbrev-alias gp="git push" 
abbrev-alias gcam="git commit -am \""
# for the tmux's
abbrev-alias t="tmux"
abbrev-alias ta="tmux attach -t"
abbrev-alias tls="tmux ls"
abbrev-alias tn="tmux new -t"
### Docker alias's ###
abbrev-alias di="docker inspect"
abbrev-alias dockershell="docker run --rm -i -t --entrypoint=/bin/bash"
abbrev-alias dockershellsh="docker run --rm -i -t --entrypoint=/bin/sh"
abbrev-alias impacket="docker run --rm -it rflathers/impacket"
abbrev-alias nginxhere='docker run --rm -it -p 80:80 -p 443:443 -v "${PWD}:/srv/data" rflathers/nginxserve'
abbrev-alias refreshgitkey="ssh-add ~/.ssh/id_ly4e_github"

#abbrev-alias fzf_dot='rg --files --hidden -g "\!.git" | fzf' 
#
## brew alias for MacOS
# abbrev-alias bbd="brew bundle dump --force --describe"
